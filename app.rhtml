<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Little Bit of Magic</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="min-h-screen bg-gradient-to-br from-slate-200 via-slate-100 to-slate-300 text-slate-900">
    <div class="mx-auto mb-5 max-w-3xl px-4 py-10">
      <% if game.not_started_yet? %>
        <p class="text-2xl font-semibold">
          Are you ready for a Little Bit of Magic?
        </p>

        <p class="mt-4 text-lg">
          If you are, think of a number between&nbsp;<%= game.first_number %>&nbsp;and&nbsp;<%= game.last_number %>.
        </p>

        <div class="mt-6 text-lg">
          Ready?

          <form class="ml-2 inline-block" method="post">
            <button
              type="submit"
              class="font-semibold text-blue-600 underline-offset-2 transition hover:underline focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-500"
              name="card_index"
              value="<%= next_card_index %>"
            >
              Yes, let's go!
            </button>
          </form>
        </div>
      <% elsif game.any_cards_left? %>
        <p class="mb-8 text-center text-2xl font-semibold">Is your number here?</p>

        <form method="post">
          <% if next_card_index %>
            <input type="hidden" name="card_index" value="<%= next_card_index %>">
          <% end %>

          <% game.answers.each do |answer| %>
            <input type="hidden" name="answers[<%= answer[:index] %>]" value="<%= answer[:value] %>">
          <% end %>

          <div class="overflow-hidden rounded-lg border border-slate-200 bg-white shadow-sm">
            <table class="w-full table-fixed border-collapse">
              <tbody>
                <% game.numbers_table.each do |row| %>
                  <tr>
                    <% row.each do |number| %>
                      <td class="border border-slate-200 p-4 text-center text-2xl font-semibold text-slate-800"><%= number %></td>
                    <% end %>
                  </tr>
                <% end %>
              </tbody>
            </table>
          </div>

          <div class="mt-8 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between">
            <button
              type="submit"
              name="answers[<%= game.current_card_index %>]"
              value="1"
              class="flex-1 rounded-md border border-green-600 bg-white px-6 py-3 text-base font-semibold text-green-700 shadow-sm transition hover:border-green-700 hover:bg-green-50 hover:text-green-800 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-green-600 sm:max-w-xs"
            >
              ğŸ‘ My number is there
            </button>
            <button
              type="submit"
              name="answers[<%= game.current_card_index %>]"
              value="0"
              class="flex-1 rounded-md border border-red-600 bg-white px-6 py-3 text-base font-semibold text-red-700 shadow-sm transition hover:border-red-700 hover:bg-red-50 hover:text-red-800 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-red-600 sm:max-w-xs"
            >
              My number is not there ğŸ‘
            </button>
          </div>
        </form>

        <p class="mt-12 border-t border-slate-200 pt-6 text-sm text-slate-500">
          <a class="font-medium text-slate-500 underline-offset-4 hover:text-slate-700 hover:underline" href="<%= h root_url %>">I want to start over</a>
        </p>
      <% elsif game.result_ready? %>
        <p class="text-lg">
          Let me think...
        </p>

        <p class="mt-4 text-2xl">
          Was <strong class="font-semibold text-blue-600"><%= game.magic_number %></strong> the number you thought of?
        </p>

        <p class="mt-8">
          <a class="font-semibold text-blue-600 underline-offset-4 hover:underline" href="<%= h root_url %>">Let me try again!</a>
        </p>
      <% end %>
    </div>
  </body>
</html>
